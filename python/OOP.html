<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>OOP | lei’s blog’</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="OOP" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="This is lei’s knowledge collection website, not for public use." /> <meta property="og:description" content="This is lei’s knowledge collection website, not for public use." /> <link rel="canonical" href="https://lei0lei.github.io/python/OOP" /> <meta property="og:url" content="https://lei0lei.github.io/python/OOP" /> <meta property="og:site_name" content="lei’s blog’" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="OOP" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"This is lei’s knowledge collection website, not for public use.","headline":"OOP","url":"https://lei0lei.github.io/python/OOP"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> lei's blog' </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in DevOps category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/" class="nav-list-link">DevOps</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Git category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/Git/" class="nav-list-link">Git</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Github category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/Github/" class="nav-list-link">Github</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Gitlab category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/Gitlab/" class="nav-list-link">Gitlab</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in MLOps category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/MLOps/" class="nav-list-link">MLOps</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in MachineLearning category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/" class="nav-list-link">MachineLearning</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in jax category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/jax/" class="nav-list-link">jax</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in model category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/model/" class="nav-list-link">model</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/model/CNN" class="nav-list-link">CNN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/GNN" class="nav-list-link">GNN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/RNN" class="nav-list-link">RNN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/SVM" class="nav-list-link">SVM</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/Transformer" class="nav-list-link">Transformer</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/yolo" class="nav-list-link">yolo</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in pytorch category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/pytorch/" class="nav-list-link">pytorch</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/pytorch/DP" class="nav-list-link">DP</a> </li><li class="nav-list-item "> <a href="/python/DVC" class="nav-list-link">DVC</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/NN" class="nav-list-link">NN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/autograd" class="nav-list-link">autograd</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/basis" class="nav-list-link">basis</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/cuda" class="nav-list-link">cuda</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/frontend" class="nav-list-link">frontend</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/internal" class="nav-list-link">internal</a> </li><li class="nav-list-item "> <a href="/python/mlflow" class="nav-list-link">mlflow</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/optimize" class="nav-list-link">optimize</a> </li><li class="nav-list-item "> <a href="/python/pytorch-lightning" class="nav-list-link">pytorch lightning</a> </li><li class="nav-list-item "> <a href="/python/steps2model" class="nav-list-link">steps2model</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in cpp category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/" class="nav-list-link">cpp</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in GSL category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/GSL/" class="nav-list-link">GSL</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in STL category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/STL/" class="nav-list-link">STL</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in StandardLibrary category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/StandardLibrary/" class="nav-list-link">StandardLibrary</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in designpattern category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/designpattern/" class="nav-list-link">designpattern</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in EventDriven category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/designpattern/EventDriven" class="nav-list-link">EventDriven</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in ServiceOriented category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/designpattern/ServiceOriented" class="nav-list-link">ServiceOriented</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in go category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/go/" class="nav-list-link">go</a><ul class="nav-list"></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in howtos category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/how-tos/" class="nav-list-link">howtos</a><ul class="nav-list"><li class="nav-list-item "><a href="/how-tos/github-pages/" class="nav-list-link">howtos-ghpages</a></li></ul></li><li class="nav-list-item"><a href="/micellaneous/" class="nav-list-link">micellaneous</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in python category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/python/" class="nav-list-link">python</a><ul class="nav-list"><li class="nav-list-item "><a href="/python/101" class="nav-list-link">101</a></li><li class="nav-list-item "><a href="/python/DependencyInjector" class="nav-list-link">DependencyInjector</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in DesignPattern category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/python/DesignPattern/" class="nav-list-link">DesignPattern</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/designpattern/functionmethod" class="nav-list-link">Factory Method Pattern</a> </li></ul></li><li class="nav-list-item active"><a href="/python/OOP" class="nav-list-link active">OOP</a></li><li class="nav-list-item "><a href="/python/asyncio" class="nav-list-link">asyncio</a></li><li class="nav-list-item "><a href="/python/dataclass" class="nav-list-link">dataclass</a></li><li class="nav-list-item "><a href="/python/decorator" class="nav-list-link">decorator</a></li><li class="nav-list-item "><a href="/python/import" class="nav-list-link">import</a></li><li class="nav-list-item "><a href="/python/interface" class="nav-list-link">interface</a></li><li class="nav-list-item "><a href="/python/iterator" class="nav-list-link">iterator</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in packages category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/python/packages" class="nav-list-link">packages</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/packages/attrs" class="nav-list-link">attrs</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/click" class="nav-list-link">click</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/cookiecutter" class="nav-list-link">cookiecutter</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/functools" class="nav-list-link">functools</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/manim" class="nav-list-link">manim</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/numpy" class="nav-list-link">numpy</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/pandas" class="nav-list-link">pandas</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/pants" class="nav-list-link">pants</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/pytest" class="nav-list-link">pytest</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/rich" class="nav-list-link">rich</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/scipy" class="nav-list-link">scipy</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/sqlAlchemy" class="nav-list-link">sqlAlchemy</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/tqdm" class="nav-list-link">tqdm</a> </li></ul></li><li class="nav-list-item "><a href="/python/style" class="nav-list-link">python style</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in web category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/" class="nav-list-link">web</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in js category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/js" class="nav-list-link">js</a><ul class="nav-list"><li class="nav-list-item "> <a href="/web/js/basics" class="nav-list-link">basics</a> </li><li class="nav-list-item "> <a href="/web/js/objects" class="nav-list-link">objects</a> </li><li class="nav-list-item "> <a href="/web/js/styles" class="nav-list-link">styles</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in nodejs category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/nodejs" class="nav-list-link">nodejs</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in wasm category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/wasm" class="nav-list-link">wasm</a><ul class="nav-list"></ul></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search lei's blog'" aria-label="Search lei's blog'" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/python/">python</a></li> <li class="breadcrumb-nav-list-item"><span>OOP</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#oop" id="markdown-toc-oop">OOP</a> <ol> <li><a href="#定义类" id="markdown-toc-定义类">定义类</a> <ol> <li><a href="#类vs实例" id="markdown-toc-类vs实例">类vs实例</a></li> <li><a href="#如何定义类" id="markdown-toc-如何定义类">如何定义类</a></li> </ol> </li> <li><a href="#实例化类" id="markdown-toc-实例化类">实例化类</a> <ol> <li><a href="#类和实例属性" id="markdown-toc-类和实例属性">类和实例属性</a></li> <li><a href="#实例方法" id="markdown-toc-实例方法">实例方法</a></li> </ol> </li> <li><a href="#继承" id="markdown-toc-继承">继承</a> <ol> <li><a href="#父类-vs-子类" id="markdown-toc-父类-vs-子类">父类 VS 子类</a></li> <li><a href="#扩展父类的功能" id="markdown-toc-扩展父类的功能">扩展父类的功能</a></li> </ol> </li> </ol> </li> <li><a href="#实例类和静态方法" id="markdown-toc-实例类和静态方法">实例、类和静态方法</a></li> <li><a href="#重载" id="markdown-toc-重载">重载</a></li> <li><a href="#属性" id="markdown-toc-属性">属性</a></li> <li><a href="#继承和多态" id="markdown-toc-继承和多态">继承和多态</a></li> <li><a href="#dataclass" id="markdown-toc-dataclass">dataclass</a> <ol> <li><a href="#替代dataclass" id="markdown-toc-替代dataclass">替代dataclass</a></li> </ol> </li> <li><a href="#构造器" id="markdown-toc-构造器">构造器</a></li> <li><a href="#多重构造器" id="markdown-toc-多重构造器">多重构造器</a></li> <li><a href="#metaclass" id="markdown-toc-metaclass">metaclass</a> <ol> <li><a href="#类型和类" id="markdown-toc-类型和类">类型和类</a></li> </ol> </li> </ol> </details> <p>https://realpython.com/python3-object-oriented-programming/</p> <p>https://realpython.com/python-super/</p> <h1 id="oop"> <a href="#oop" class="anchor-heading" aria-labelledby="oop"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/python3-object-oriented-programming/">OOP</a> </h1> <p>面向对象编程是一个编程范式，将属性和行为绑定到独立的对象上。 对应的另一种常见的范式是过程式编程。</p> <h2 id="定义类"> <a href="#定义类" class="anchor-heading" aria-labelledby="定义类"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 定义类 </h2> <p>基础的数据结构像number,string以及list，用于表示简单的信息，如果需要表示一些复杂的东西比如追踪一个人员在组织中的行为，需要保存该人员的基础信息比如姓名，年龄，职位，工作年龄，一种方式是使用list表示:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kirk</span> <span class="o">=</span> <span class="p">[</span><span class="s">"James Kirk"</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="s">"Captain"</span><span class="p">,</span> <span class="mi">2265</span><span class="p">]</span>
<span class="n">spock</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Spock"</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="s">"Science Officer"</span><span class="p">,</span> <span class="mi">2254</span><span class="p">]</span>
<span class="n">mccoy</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Leonard McCoy"</span><span class="p">,</span> <span class="s">"Chief Medical Officer"</span><span class="p">,</span> <span class="mi">2266</span><span class="p">]</span>
</code></pre></div></div> <p>这种方法存在很多问题，大的代码文件很难管理，如果在其他地方引用kirk很难记住kirk的实际定义。第二，如果每个人员的元素数量并不相同就会产生错误，比如<code class="language-plaintext highlighter-rouge">mccoy</code>.更好的替代方式就是使用类来方便管理和维护。</p> <h3 id="类vs实例"> <a href="#类vs实例" class="anchor-heading" aria-labelledby="类vs实例"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 类vs实例 </h3> <p>类用于创建用户自定义的数据结构，类定义的函数叫做方法，定义了从该类创建的对象操作其数据的行为和方法。</p> <p>类是一个蓝图表示某个东西应该如何定义，不包含实际的数据，比如一个<code class="language-plaintext highlighter-rouge">Dog</code>类并不包含实际的狗的年龄和名字。实际包含数据的是类实例化出来的对象。</p> <h3 id="如何定义类"> <a href="#如何定义类" class="anchor-heading" aria-labelledby="如何定义类"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 如何定义类 </h3> <p>类的定义使用<code class="language-plaintext highlighter-rouge">class</code>关键字，后面跟着类的名字和冒号。下面是一个例子:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">Dog</code>类的body包含一个语句:pass语句，这是一个占位符。让我们给这个类加一些内容，首先所有的<code class="language-plaintext highlighter-rouge">Dog</code>对象都必须要定义一个叫做<code class="language-plaintext highlighter-rouge">.__init__()</code>的方法，每次一个新的对象创建，<code class="language-plaintext highlighter-rouge">.__init__()</code>都会给属性进行赋值来设置对象的初始状态。<code class="language-plaintext highlighter-rouge">.__init__()</code>可以包含任意数量的参数，但是第一个参数必须叫做<code class="language-plaintext highlighter-rouge">self</code>.当创建新的类实例的时候，实例自动传给<code class="language-plaintext highlighter-rouge">self</code>参数，这样才可以定义新的属性。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</code></pre></div></div> <p>在<code class="language-plaintext highlighter-rouge">.__init__()</code>中创建的属性叫做实例属性，实例的属性对不同的对象是不同的可以在<code class="language-plaintext highlighter-rouge">__init__()</code>之外给一个变量命名。类的属性对所有的类实例相同，在<code class="language-plaintext highlighter-rouge">__init__()</code>之外可以定义类属性，比如:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="c1"># Class attribute
</span>    <span class="n">species</span> <span class="o">=</span> <span class="s">"Canis familiaris"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</code></pre></div></div> <p>类的属性必须有初始值，在实例创建的时候，类属性会自动创建和赋值。</p> <h2 id="实例化类"> <a href="#实例化类" class="anchor-heading" aria-labelledby="实例化类"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 实例化类 </h2> <p>创建对象的过程叫做对象的实例化，</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Dog</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Dog</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x106702d30</span><span class="o">&gt;</span>
</code></pre></div></div> <p>现在在内存地址<code class="language-plaintext highlighter-rouge">0x106702d30</code>处有了新的对象，再来创建一个新的对象，</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="bp">False</span>
</code></pre></div></div> <p>如果使用<code class="language-plaintext highlighter-rouge">==</code>操作符比较两个对象会发现结果是<code class="language-plaintext highlighter-rouge">False</code>，因为表示内存中的不同对象。</p> <h3 id="类和实例属性"> <a href="#类和实例属性" class="anchor-heading" aria-labelledby="类和实例属性"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 类和实例属性 </h3> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="n">species</span> <span class="o">=</span> <span class="s">"Canis familiaris"</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</code></pre></div></div> <p>要实例化一个对象需要给<code class="language-plaintext highlighter-rouge">name</code>和<code class="language-plaintext highlighter-rouge">age</code>一个值:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Dog</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">"&lt;pyshell#6&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">Dog</span><span class="p">()</span>
<span class="nb">TypeError</span><span class="p">:</span> <span class="n">__init__</span><span class="p">()</span> <span class="n">missing</span> <span class="mi">2</span> <span class="n">required</span> <span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span> <span class="s">'name'</span> <span class="ow">and</span> <span class="s">'age'</span>
</code></pre></div></div> <p>要初始化直接放在括号里即可:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">buddy</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Buddy"</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">miles</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Miles"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</code></pre></div></div> <p>这会创建两个实例，在实例化<code class="language-plaintext highlighter-rouge">Dog</code>对象的时候，python 会创建一个新的实例然后传递给<code class="language-plaintext highlighter-rouge">.__init__()</code>的第一个参数。</p> <p>创建了实例后可以通过<code class="language-plaintext highlighter-rouge">.</code>写法来进行属性访问：</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span><span class="p">.</span><span class="n">name</span>
<span class="s">'Buddy'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span><span class="p">.</span><span class="n">age</span>
<span class="mi">9</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">name</span>
<span class="s">'Miles'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">age</span>
<span class="mi">4</span>
</code></pre></div></div> <p>可以以相同的方式访问类的属性:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span><span class="p">.</span><span class="n">species</span>
<span class="s">'Canis familiaris'</span>
</code></pre></div></div> <p>使用类来组织数据的优点是实例保证会有期望的属性，因此总会返回一个值。</p> <p>尽管属性一定会存在，其值可以动态的改变:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span><span class="p">.</span><span class="n">age</span>
<span class="mi">10</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">species</span> <span class="o">=</span> <span class="s">"Felis silvestris"</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">species</span>
<span class="s">'Felis silvestris'</span>
</code></pre></div></div> <p>自定义个对象默认上是<code class="language-plaintext highlighter-rouge">mutable</code>的，换句话说，可以被动态改变，比如lists和dict都是<code class="language-plaintext highlighter-rouge">mutable</code>，但是string和tuple是<code class="language-plaintext highlighter-rouge">immutable</code>.</p> <h3 id="实例方法"> <a href="#实例方法" class="anchor-heading" aria-labelledby="实例方法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 实例方法 </h3> <p>实例方法是在类里面定义的函数并且只能从类的实力进行调用，实例方法的第一个参数都是<code class="language-plaintext highlighter-rouge">self</code>,</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="n">species</span> <span class="o">=</span> <span class="s">"Canis familiaris"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>

    <span class="c1"># Instance method
</span>    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> is </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">age</span><span class="si">}</span><span class="s"> years old"</span>

    <span class="c1"># Another instance method
</span>    <span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> says </span><span class="si">{</span><span class="n">sound</span><span class="si">}</span><span class="s">"</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">Dog</code>类有两个实例方法:</p> <ul> <li><code class="language-plaintext highlighter-rouge">.description()</code>返回一个字符串显示狗的name和age.</li> <li><code class="language-plaintext highlighter-rouge">.speak()</code>有一个叫做sound的参数并返回name和sound.</li> </ul> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Miles"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">description</span><span class="p">()</span>
<span class="s">'Miles is 4 years old'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">speak</span><span class="p">(</span><span class="s">"Woof Woof"</span><span class="p">)</span>
<span class="s">'Miles says Woof Woof'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">speak</span><span class="p">(</span><span class="s">"Bow Wow"</span><span class="p">)</span>
<span class="s">'Miles says Bow Wow'</span>
</code></pre></div></div> <p>在写自己的类的时候，包含一个方法来返回这个类的一些信息通常是有用的，但是<code class="language-plaintext highlighter-rouge">.description()</code>不是那么的<code class="language-plaintext highlighter-rouge">Pythonic</code>.</p> <p>当我们<code class="language-plaintext highlighter-rouge">print</code>一个类的时候:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Dog</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x00aeff70</span><span class="o">&gt;</span>
</code></pre></div></div> <p>返回的信息并没有什么用，通过改变一个特殊的实例方法<code class="language-plaintext highlighter-rouge">.__str__()</code>可以改变这个行为:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="c1"># Leave other parts of Dog class as-is
</span>
    <span class="c1"># Replace .description() with __str__()
</span>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> is </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">age</span><span class="si">}</span><span class="s"> years old"</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Miles"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<span class="s">'Miles is 4 years old'</span>
</code></pre></div></div> <p>前后置双下下划线在python中叫做<code class="language-plaintext highlighter-rouge">dunder methods</code>。</p> <h2 id="继承"> <a href="#继承" class="anchor-heading" aria-labelledby="继承"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 继承 </h2> <p>继承允许一个类得到另一个类的属性和方法，新类叫做子类。子类可以覆盖或者扩展父类的属性和方法，换句话说，子类继承了父类的所有属性和方法但同时实现了自己的属性和方法。</p> <p>比如我们要给狗加入一个品种的属性区分不同的狗，一种方式是直接添加属性，这样既需要在实例化的时候额外传入一个参数；</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="n">species</span> <span class="o">=</span> <span class="s">"Canis familiaris"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">breed</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">breed</span> <span class="o">=</span> <span class="n">breed</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Miles"</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">"Jack Russell Terrier"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Buddy"</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s">"Dachshund"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jack</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Jack"</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">"Bulldog"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jim</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">(</span><span class="s">"Jim"</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s">"Bulldog"</span><span class="p">)</span>
</code></pre></div></div> <p>但是每只品种的狗有不同的行为，比如斗牛叫声是woof,dachshund叫声是yap,如果只使用一个类每次就需要给speak额外添加一个参数,这会很麻烦，而且一只狗的叫声应该取决于其品种。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span><span class="p">.</span><span class="n">speak</span><span class="p">(</span><span class="s">"Yap"</span><span class="p">)</span>
<span class="s">'Buddy says Yap'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">jim</span><span class="p">.</span><span class="n">speak</span><span class="p">(</span><span class="s">"Woof"</span><span class="p">)</span>
<span class="s">'Jim says Woof'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">jack</span><span class="p">.</span><span class="n">speak</span><span class="p">(</span><span class="s">"Woof"</span><span class="p">)</span>
<span class="s">'Jack says Woof'</span>
</code></pre></div></div> <p>创建一个子类可以解决这个问题，每个子类可以继承speak功能进行改造,包括为每个子类定义一个默认参数。</p> <h3 id="父类-vs-子类"> <a href="#父类-vs-子类" class="anchor-heading" aria-labelledby="父类-vs-子类"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 父类 VS 子类 </h3> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
    <span class="n">species</span> <span class="o">=</span> <span class="s">"Canis familiaris"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> is </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">age</span><span class="si">}</span><span class="s"> years old"</span>

    <span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> says </span><span class="si">{</span><span class="n">sound</span><span class="si">}</span><span class="s">"</span>

<span class="k">class</span> <span class="nc">JackRussellTerrier</span><span class="p">(</span><span class="n">Dog</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Dachshund</span><span class="p">(</span><span class="n">Dog</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Bulldog</span><span class="p">(</span><span class="n">Dog</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></div> <p>要创建子类只需要将父类名字放在括号中。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span> <span class="o">=</span> <span class="n">JackRussellTerrier</span><span class="p">(</span><span class="s">"Miles"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span> <span class="o">=</span> <span class="n">Dachshund</span><span class="p">(</span><span class="s">"Buddy"</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jack</span> <span class="o">=</span> <span class="n">Bulldog</span><span class="p">(</span><span class="s">"Jack"</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jim</span> <span class="o">=</span> <span class="n">Bulldog</span><span class="p">(</span><span class="s">"Jim"</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div></div> <p>子类的实例继承了父类的所有属性和方法:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">species</span>
<span class="s">'Canis familiaris'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">buddy</span><span class="p">.</span><span class="n">name</span>
<span class="s">'Buddy'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="n">Jack</span> <span class="ow">is</span> <span class="mi">3</span> <span class="n">years</span> <span class="n">old</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">jim</span><span class="p">.</span><span class="n">speak</span><span class="p">(</span><span class="s">"Woof"</span><span class="p">)</span>
<span class="s">'Jim says Woof'</span>
</code></pre></div></div> <p>要确定对象属于哪个类只需要使用内建的<code class="language-plaintext highlighter-rouge">type()</code>：</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">miles</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">__main__</span><span class="p">.</span><span class="n">JackRussellTerrier</span><span class="s">'&gt;
</span></code></pre></div></div> <p>如果想要知道某个对象是否是类的实例只需要使用内建的<code class="language-plaintext highlighter-rouge">isinstance()</code>:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">miles</span><span class="p">,</span> <span class="n">Dog</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">isinstance()</code>有两个参数，第一个是对象，第二个是类。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">miles</span><span class="p">,</span> <span class="n">Bulldog</span><span class="p">)</span>
<span class="bp">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">Dachshund</span><span class="p">)</span>
<span class="bp">False</span>
</code></pre></div></div> <p>从子类创建的对象都是父类的实例。</p> <h3 id="扩展父类的功能"> <a href="#扩展父类的功能" class="anchor-heading" aria-labelledby="扩展父类的功能"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 扩展父类的功能 </h3> <p>由于不同品种的狗不同的叫声，可以为子类的<code class="language-plaintext highlighter-rouge">.speak()</code>方法提供一个默认值，只需要覆盖<code class="language-plaintext highlighter-rouge">.speak()</code>方法。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">JackRussellTerrier</span><span class="p">(</span><span class="n">Dog</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound</span><span class="o">=</span><span class="s">"Arf"</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> says </span><span class="si">{</span><span class="n">sound</span><span class="si">}</span><span class="s">"</span>
</code></pre></div></div> <p>要覆盖父类的方法只需要在子类中命名相同的方法:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span> <span class="o">=</span> <span class="n">JackRussellTerrier</span><span class="p">(</span><span class="s">"Miles"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">speak</span><span class="p">()</span>
<span class="s">'Miles says Arf'</span>
</code></pre></div></div> <p>有的时候我们会需要完全覆盖父类的方法，但是有时我们需要保留父类的东西，可以在子类中哦功能调用父类的方法,使用<code class="language-plaintext highlighter-rouge">super()</code>：</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">JackRussellTerrier</span><span class="p">(</span><span class="n">Dog</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound</span><span class="o">=</span><span class="s">"Arf"</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">().</span><span class="n">speak</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span>
</code></pre></div></div> <p>调用<code class="language-plaintext highlighter-rouge">super()</code>的时候python回去搜索父类<code class="language-plaintext highlighter-rouge">Dog</code>中的`.speak方法。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span> <span class="o">=</span> <span class="n">JackRussellTerrier</span><span class="p">(</span><span class="s">"Miles"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">miles</span><span class="p">.</span><span class="n">speak</span><span class="p">()</span>
<span class="s">'Miles barks: Arf'</span>
</code></pre></div></div> <h1 id="实例类和静态方法"> <a href="#实例类和静态方法" class="anchor-heading" aria-labelledby="实例类和静态方法"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/instance-class-and-static-methods-demystified/">实例、类和静态方法</a> </h1> <h1 id="重载"> <a href="#重载" class="anchor-heading" aria-labelledby="重载"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/operator-function-overloading/">重载</a> </h1> <h1 id="属性"> <a href="#属性" class="anchor-heading" aria-labelledby="属性"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/python-property/">属性</a> </h1> <h1 id="继承和多态"> <a href="#继承和多态" class="anchor-heading" aria-labelledby="继承和多态"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/inheritance-composition-python/">继承和多态</a> </h1> <h1 id="dataclass"> <a href="#dataclass" class="anchor-heading" aria-labelledby="dataclass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/python-data-classes/">dataclass</a> </h1> <p>在3.7版本之后python加入了数据类，这种类主要包含数据，使用<code class="language-plaintext highlighter-rouge">@dataclass</code>装饰器:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">DataClassCard</span><span class="p">:</span>
    <span class="n">rank</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">suit</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></div> <p>dataclass已经实现了一些基础的功能比如实例化，打印，比较大小等。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span> <span class="o">=</span> <span class="n">DataClassCard</span><span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span><span class="p">.</span><span class="n">rank</span>
<span class="s">'Q'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span>
<span class="n">DataClassCard</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="s">'Q'</span><span class="p">,</span> <span class="n">suit</span><span class="o">=</span><span class="s">'Hearts'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span> <span class="o">==</span> <span class="n">DataClassCard</span><span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></div></div> <p>正常的类看起来是下面这种：</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RegularCard</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">suit</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rank</span> <span class="o">=</span> <span class="n">rank</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">suit</span> <span class="o">=</span> <span class="n">suit</span>
</code></pre></div></div> <p>可以看出我们要重复写一些名字，而且因为一些因素有下面一个小问题:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span> <span class="o">=</span> <span class="n">RegularCard</span><span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span><span class="p">.</span><span class="n">rank</span>
<span class="s">'Q'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">RegularCard</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7fb6eee35d30</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span> <span class="o">==</span> <span class="n">RegularCard</span><span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="bp">False</span>
</code></pre></div></div> <p>dataclass看上去暗中帮我们做了一些事情，默认情况下,dataclass实现了一个<code class="language-plaintext highlighter-rouge">.__repr__()</code>方法来提供好看的字符串表示以及<code class="language-plaintext highlighter-rouge">.__eq__()</code>方法进行对象的比较。对于<code class="language-plaintext highlighter-rouge">RegularCard</code>如果要看起来像上面一样，需要添加方法:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RegularCard</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">suit</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rank</span> <span class="o">=</span> <span class="n">rank</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">suit</span> <span class="o">=</span> <span class="n">suit</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">__class__</span><span class="p">.</span><span class="n">__name__</span><span class="si">}</span><span class="s">'</span>
                <span class="sa">f</span><span class="s">'(rank=</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">rank</span><span class="err">!</span><span class="n">r</span><span class="si">}</span><span class="s">, suit=</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">suit</span><span class="err">!</span><span class="n">r</span><span class="si">}</span><span class="s">)'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">other</span><span class="p">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">__class__</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">NotImplemented</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rank</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">suit</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">rank</span><span class="p">,</span> <span class="n">other</span><span class="p">.</span><span class="n">suit</span><span class="p">)</span>
</code></pre></div></div> <p>接下来我们将看到</p> <ul> <li>如何给dataclass添加默认值</li> <li>dataclass如何实现对象的排序</li> <li>如何表示immutable数据</li> <li>dataclass如何处理继承</li> </ul> <h2 id="替代dataclass"> <a href="#替代dataclass" class="anchor-heading" aria-labelledby="替代dataclass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 替代dataclass </h2> <p>对于简单的数据结构可能使用过tuple或者dict,比如:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">'rank'</span><span class="p">:</span> <span class="s">'Q'</span><span class="p">,</span> <span class="s">'suit'</span><span class="p">:</span> <span class="s">'Hearts'</span><span class="p">}</span>
</code></pre></div></div> <p>但是对于编程者来说有许多需要做的事:</p> <ul> <li>需要记住<code class="language-plaintext highlighter-rouge">queen_of_hearts_...</code>变量表示扑克</li> <li>对于tuple版本，需要记住属性顺序，<code class="language-plaintext highlighter-rouge">('Spades', 'A')</code>可能不会报错</li> <li>如果使用dict版本需要确保属性名是一致的，比如<code class="language-plaintext highlighter-rouge">{'value': 'A', 'suit': 'Spades'}</code>可能不会有效</li> </ul> <p>下面的写法可能不太雅观:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># No named access
</span><span class="s">'Q'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts_dict</span><span class="p">[</span><span class="s">'suit'</span><span class="p">]</span>  <span class="c1"># Would be nicer with .suit
</span><span class="s">'Hearts'</span>
</code></pre></div></div> <p>一个替代品是<code class="language-plaintext highlighter-rouge">namedtuple</code>，用来创建可读的小型数据结构。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">NamedTupleCard</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">'NamedTupleCard'</span><span class="p">,</span> <span class="p">[</span><span class="s">'rank'</span><span class="p">,</span> <span class="s">'suit'</span><span class="p">])</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">NamedTupleCard</code>将会给出像dataclass一样的结果:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span> <span class="o">=</span> <span class="n">NamedTupleCard</span><span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span><span class="p">.</span><span class="n">rank</span>
<span class="s">'Q'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span>
<span class="n">NamedTupleCard</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="s">'Q'</span><span class="p">,</span> <span class="n">suit</span><span class="o">=</span><span class="s">'Hearts'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span> <span class="o">==</span> <span class="n">NamedTupleCard</span><span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></div></div> <p>那么为什么还要使用dataclass, 首先，dataclass 有更丰富的特征，同时<code class="language-plaintext highlighter-rouge">namedtuple</code>有一些不太好的特征，设计上来看，<code class="language-plaintext highlighter-rouge">namedtuple</code>就是一个普通的tuple，从比较上来看就能看出来：</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">queen_of_hearts</span> <span class="o">==</span> <span class="p">(</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'Hearts'</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></div></div> <p>看上去没问题但是缺乏类型使其容易出现隐藏的bug,尤其是比较两个不同的<code class="language-plaintext highlighter-rouge">namedtuple</code>类时:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Person</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">'Person'</span><span class="p">,</span> <span class="p">[</span><span class="s">'first_initial'</span><span class="p">,</span> <span class="s">'last_name'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ace_of_spades</span> <span class="o">=</span> <span class="n">NamedTupleCard</span><span class="p">(</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'Spades'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ace_of_spades</span> <span class="o">==</span> <span class="n">Person</span><span class="p">(</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'Spades'</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">namedtuple</code>还会带来一些限制，比如很难添加默认值，本身也是immutable.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">card</span> <span class="o">=</span> <span class="n">NamedTupleCard</span><span class="p">(</span><span class="s">'7'</span><span class="p">,</span> <span class="s">'Diamonds'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">card</span><span class="p">.</span><span class="n">rank</span> <span class="o">=</span> <span class="s">'9'</span>
<span class="nb">AttributeError</span><span class="p">:</span> <span class="n">can</span><span class="s">'t set attribute
</span></code></pre></div></div> <p>dataclass 不会完全取代namedtuple.比如如果需要数据结构的行为像tuple一样，最好使用namedtuple.</p> <p>另一种方式是<a href="https://www.attrs.org/en/stable/">attrs project</a>,</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">attr</span>

<span class="o">@</span><span class="n">attr</span><span class="p">.</span><span class="n">s</span>
<span class="k">class</span> <span class="nc">AttrsCard</span><span class="p">:</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="n">attr</span><span class="p">.</span><span class="n">ib</span><span class="p">()</span>
    <span class="n">suit</span> <span class="o">=</span> <span class="n">attr</span><span class="p">.</span><span class="n">ib</span><span class="p">()</span>
</code></pre></div></div> <p>.</p> <h1 id="构造器"> <a href="#构造器" class="anchor-heading" aria-labelledby="构造器"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/python-class-constructor/">构造器</a> </h1> <h1 id="多重构造器"> <a href="#多重构造器" class="anchor-heading" aria-labelledby="多重构造器"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/python-multiple-constructors/">多重构造器</a> </h1> <h1 id="metaclass"> <a href="#metaclass" class="anchor-heading" aria-labelledby="metaclass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://realpython.com/python-metaclasses/">metaclass</a> </h1> <p>元编程是指程序知道自己本身或者有能力控制自身，python对类的元编程叫做metaclass.这是一种隐藏的OOP概念，在使用的时候可能根本意识不到或者说没有必要去意识到。</p> <p>python提供了其他OOP语言不支持的能力:可以自定义metaclass.但是metaclass是比较有争议的:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>“Metaclasses are deeper magic than 99% of users should ever worry about. If you wonder whether you need them, you don’t (the people who actually need them know with certainty that they need them, and don’t need an explanation about why).”
</code></pre></div></div> <p>有的python学者相信我们永远不该使用自定义的metaclass,大多数情况下自定义的metaclass没有必要。</p> <p>但是python的metaclass还是有必要了解，可能更好的了解python类的内部原理。</p> <p>python中，类有两种变体，没有正式的名字，姑且叫做旧风格和新风格的类。</p> <p>在旧风格的类中，类和类型不是一个相同的东西，旧风格的类的实例是用单独的内建类型<code class="language-plaintext highlighter-rouge">instance</code>实现的。如果<code class="language-plaintext highlighter-rouge">obj</code>是旧风格的类的实例，<code class="language-plaintext highlighter-rouge">obj.__class__</code>来指定类，但是<code class="language-plaintext highlighter-rouge">type(obj)</code>总是<code class="language-plaintext highlighter-rouge">instance</code>,如下面python2.7的例子:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
<span class="p">...</span>     <span class="k">pass</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">__class__</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="nc">__main__</span><span class="p">.</span><span class="n">Foo</span> <span class="n">at</span> <span class="mh">0x000000000535CC48</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&lt;</span><span class="nb">type</span> <span class="s">'instance'</span><span class="o">&gt;</span>
</code></pre></div></div> <p>新风格的类统一了类和类型的概念。如果<code class="language-plaintext highlighter-rouge">obj</code>是新风格的类的实例，<code class="language-plaintext highlighter-rouge">type(obj)</code>和<code class="language-plaintext highlighter-rouge">obj.__class__</code>相同:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
<span class="p">...</span>     <span class="k">pass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obj</span><span class="p">.</span><span class="n">__class__</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">__main__</span><span class="p">.</span><span class="n">Foo</span><span class="s">'&gt;
&gt;&gt;&gt; type(obj)
&lt;class '</span><span class="n">__main__</span><span class="p">.</span><span class="n">Foo</span><span class="s">'&gt;
&gt;&gt;&gt; obj.__class__ is type(obj)
True
</span></code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'x'</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'y'</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
<span class="p">...</span>     <span class="k">pass</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="p">...</span>     <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">obj</span><span class="p">.</span><span class="n">__class__</span><span class="p">)</span>
<span class="p">...</span>
<span class="bp">True</span>
<span class="bp">True</span>
<span class="bp">True</span>
</code></pre></div></div> <h2 id="类型和类"> <a href="#类型和类" class="anchor-heading" aria-labelledby="类型和类"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 类型和类 </h2> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
