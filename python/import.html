<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>import | lei’s blog’</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="import" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="This is lei’s knowledge collection website, not for public use." /> <meta property="og:description" content="This is lei’s knowledge collection website, not for public use." /> <link rel="canonical" href="https://lei0lei.github.io/python/import" /> <meta property="og:url" content="https://lei0lei.github.io/python/import" /> <meta property="og:site_name" content="lei’s blog’" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="import" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"This is lei’s knowledge collection website, not for public use.","headline":"import","url":"https://lei0lei.github.io/python/import"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> lei's blog' </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in DevOps category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/" class="nav-list-link">DevOps</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Git category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/Git/" class="nav-list-link">Git</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Github category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/Github/" class="nav-list-link">Github</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Gitlab category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/Gitlab/" class="nav-list-link">Gitlab</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in MLOps category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/DevOps/MLOps/" class="nav-list-link">MLOps</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in MachineLearning category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/" class="nav-list-link">MachineLearning</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in jax category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/jax/" class="nav-list-link">jax</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in model category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/model/" class="nav-list-link">model</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/model/CNN" class="nav-list-link">CNN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/GNN" class="nav-list-link">GNN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/RNN" class="nav-list-link">RNN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/SVM" class="nav-list-link">SVM</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/Transformer" class="nav-list-link">Transformer</a> </li><li class="nav-list-item "> <a href="/MachineLearning/model/yolo" class="nav-list-link">yolo</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in pytorch category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/MachineLearning/pytorch/" class="nav-list-link">pytorch</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/pytorch/DP" class="nav-list-link">DP</a> </li><li class="nav-list-item "> <a href="/python/DVC" class="nav-list-link">DVC</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/NN" class="nav-list-link">NN</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/autograd" class="nav-list-link">autograd</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/basis" class="nav-list-link">basis</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/cuda" class="nav-list-link">cuda</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/frontend" class="nav-list-link">frontend</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/internal" class="nav-list-link">internal</a> </li><li class="nav-list-item "> <a href="/python/mlflow" class="nav-list-link">mlflow</a> </li><li class="nav-list-item "> <a href="/MachineLearning/pytorch/optimize" class="nav-list-link">optimize</a> </li><li class="nav-list-item "> <a href="/python/pytorch-lightning" class="nav-list-link">pytorch lightning</a> </li><li class="nav-list-item "> <a href="/python/steps2model" class="nav-list-link">steps2model</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in cpp category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/" class="nav-list-link">cpp</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in GSL category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/GSL/" class="nav-list-link">GSL</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in STL category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/STL/" class="nav-list-link">STL</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in StandardLibrary category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/cpp/StandardLibrary/" class="nav-list-link">StandardLibrary</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in designpattern category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/designpattern/" class="nav-list-link">designpattern</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in EventDriven category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/designpattern/EventDriven" class="nav-list-link">EventDriven</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in ServiceOriented category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/designpattern/ServiceOriented" class="nav-list-link">ServiceOriented</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in go category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/go/" class="nav-list-link">go</a><ul class="nav-list"></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in howtos category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/how-tos/" class="nav-list-link">howtos</a><ul class="nav-list"><li class="nav-list-item "><a href="/how-tos/github-pages/" class="nav-list-link">howtos-ghpages</a></li></ul></li><li class="nav-list-item"><a href="/micellaneous/" class="nav-list-link">micellaneous</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in python category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/python/" class="nav-list-link">python</a><ul class="nav-list"><li class="nav-list-item "><a href="/python/101" class="nav-list-link">101</a></li><li class="nav-list-item "><a href="/python/DependencyInjector" class="nav-list-link">DependencyInjector</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in DesignPattern category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/python/DesignPattern/" class="nav-list-link">DesignPattern</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/designpattern/functionmethod" class="nav-list-link">Factory Method Pattern</a> </li></ul></li><li class="nav-list-item "><a href="/python/OOP" class="nav-list-link">OOP</a></li><li class="nav-list-item "><a href="/python/asyncio" class="nav-list-link">asyncio</a></li><li class="nav-list-item "><a href="/python/dataclass" class="nav-list-link">dataclass</a></li><li class="nav-list-item "><a href="/python/decorator" class="nav-list-link">decorator</a></li><li class="nav-list-item active"><a href="/python/import" class="nav-list-link active">import</a></li><li class="nav-list-item "><a href="/python/interface" class="nav-list-link">interface</a></li><li class="nav-list-item "><a href="/python/iterator" class="nav-list-link">iterator</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in packages category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/python/packages" class="nav-list-link">packages</a><ul class="nav-list"><li class="nav-list-item "> <a href="/MachineLearning/packages/attrs" class="nav-list-link">attrs</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/click" class="nav-list-link">click</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/cookiecutter" class="nav-list-link">cookiecutter</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/functools" class="nav-list-link">functools</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/manim" class="nav-list-link">manim</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/numpy" class="nav-list-link">numpy</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/pandas" class="nav-list-link">pandas</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/pants" class="nav-list-link">pants</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/pytest" class="nav-list-link">pytest</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/rich" class="nav-list-link">rich</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/scipy" class="nav-list-link">scipy</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/sqlAlchemy" class="nav-list-link">sqlAlchemy</a> </li><li class="nav-list-item "> <a href="/MachineLearning/packages/tqdm" class="nav-list-link">tqdm</a> </li></ul></li><li class="nav-list-item "><a href="/python/style" class="nav-list-link">python style</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in web category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/" class="nav-list-link">web</a><ul class="nav-list"><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in js category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/js" class="nav-list-link">js</a><ul class="nav-list"><li class="nav-list-item "> <a href="/web/js/basics" class="nav-list-link">basics</a> </li><li class="nav-list-item "> <a href="/web/js/objects" class="nav-list-link">objects</a> </li><li class="nav-list-item "> <a href="/web/js/styles" class="nav-list-link">styles</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in nodejs category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/nodejs" class="nav-list-link">nodejs</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in wasm category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/web/wasm" class="nav-list-link">wasm</a><ul class="nav-list"></ul></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search lei's blog'" aria-label="Search lei's blog'" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/python/">python</a></li> <li class="breadcrumb-nav-list-item"><span>import</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#modules" id="markdown-toc-modules">Modules</a> <ol> <li><a href="#模块的搜索路径" id="markdown-toc-模块的搜索路径">模块的搜索路径</a></li> <li><a href="#import语句" id="markdown-toc-import语句">import语句</a> <ol> <li><a href="#import-module_name" id="markdown-toc-import-module_name"><code class="language-plaintext highlighter-rouge">import &lt;module_name&gt;</code></a></li> <li><a href="#from-module_name-import-names" id="markdown-toc-from-module_name-import-names"><code class="language-plaintext highlighter-rouge">from &lt;module_name&gt; import &lt;name(s)&gt;</code></a></li> <li><a href="#from-module_name-import-name-as-alt_name" id="markdown-toc-from-module_name-import-name-as-alt_name"><code class="language-plaintext highlighter-rouge">from &lt;module_name&gt; import &lt;name&gt; as &lt;alt_name&gt;</code></a></li> <li><a href="#import-module_name-as-alt_name" id="markdown-toc-import-module_name-as-alt_name"><code class="language-plaintext highlighter-rouge">import &lt;module_name&gt; as &lt;alt_name&gt;</code></a></li> </ol> </li> <li><a href="#dir函数" id="markdown-toc-dir函数">dir函数</a></li> <li><a href="#将模块作为脚本执行" id="markdown-toc-将模块作为脚本执行">将模块作为脚本执行</a></li> <li><a href="#重新加载模块" id="markdown-toc-重新加载模块">重新加载模块</a></li> </ol> </li> <li><a href="#packages" id="markdown-toc-packages">Packages</a> <ol> <li><a href="#包初始化" id="markdown-toc-包初始化">包初始化</a></li> <li><a href="#命名空间包" id="markdown-toc-命名空间包">命名空间包</a></li> <li><a href="#import-" id="markdown-toc-import-"><code class="language-plaintext highlighter-rouge">import *</code></a></li> <li><a href="#子包" id="markdown-toc-子包">子包</a></li> </ol> </li> <li><a href="#import" id="markdown-toc-import">Import</a> <ol> <li><a href="#绝对导入" id="markdown-toc-绝对导入">绝对导入</a></li> <li><a href="#相对导入" id="markdown-toc-相对导入">相对导入</a></li> </ol> </li> <li><a href="#advanced-import" id="markdown-toc-advanced-import">Advanced import</a> <ol> <li><a href="#基础" id="markdown-toc-基础">基础</a></li> <li><a href="#资源import" id="markdown-toc-资源import">资源import</a></li> <li><a href="#动态import" id="markdown-toc-动态import">动态import</a></li> <li><a href="#import系统" id="markdown-toc-import系统">import系统</a></li> <li><a href="#tips" id="markdown-toc-tips">Tips</a></li> </ol> </li> </ol> </details> <p class="warning">ver: 0.0.1</p> <p>模块化变成将一个大的编程任务分割成几个小的可管理的子任务和模块，单独的模块可以链接在一起组成大的应用。本文将介绍python模块化的两个机制:的module和package.</p> <p>模块化变成有以下优点:</p> <ul> <li>简单，将问题分割成更小的问题，减小问题领域，开发更容易更少出错。</li> <li>可维护，不同的问题领域之间有逻辑边界，一个模块出问题不会影响程序的其他部分,更有利于多人合作。</li> <li>可服用，一个模块定义的功能可以方便的被程序的其他部分进行复用，不需要多复制一份代码</li> <li>作用域清晰，模块可以定义单独的命名空间，避免了标识符在程序的不同地方发生冲突。</li> </ul> <p>在python中，函数，模块和包都是提升程序模块化的手段。</p> <h1 id="modules"> <a href="#modules" class="anchor-heading" aria-labelledby="modules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Modules </h1> <p>python中模块的定义有三种方式:</p> <ul> <li>用python写成</li> <li>用C写然后在运行时进行动态加载，比如re模块</li> <li>内建的模块直接包含在解释器中比如itertools模块</li> </ul> <p>这三种方式都是通过<code class="language-plaintext highlighter-rouge">import</code>语句进行导入模块内容。本文主要介绍以python代码写成的模块，比如我们创建一个<code class="language-plaintext highlighter-rouge">mod.py</code>.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="s">"If Comrade Napoleon says it, it must be right."</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'arg = </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">mod</span><span class="p">.</span><span class="n">s</span><span class="p">)</span>
<span class="n">If</span> <span class="n">Comrade</span> <span class="n">Napoleon</span> <span class="n">says</span> <span class="n">it</span><span class="p">,</span> <span class="n">it</span> <span class="n">must</span> <span class="n">be</span> <span class="n">right</span><span class="p">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">a</span>
<span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">foo</span><span class="p">([</span><span class="s">'quux'</span><span class="p">,</span> <span class="s">'corge'</span><span class="p">,</span> <span class="s">'grault'</span><span class="p">])</span>
<span class="n">arg</span> <span class="o">=</span> <span class="p">[</span><span class="s">'quux'</span><span class="p">,</span> <span class="s">'corge'</span><span class="p">,</span> <span class="s">'grault'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">mod</span><span class="p">.</span><span class="n">Foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="o">&lt;</span><span class="n">mod</span><span class="p">.</span><span class="n">Foo</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x03C181F0</span><span class="o">&gt;</span>
</code></pre></div></div> <h2 id="模块的搜索路径"> <a href="#模块的搜索路径" class="anchor-heading" aria-labelledby="模块的搜索路径"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 模块的搜索路径 </h2> <p>当我们输入以下语句时会发生什么:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">mod</span>
</code></pre></div></div> <p>解释器会从一个目录列表中搜索<code class="language-plaintext highlighter-rouge">mod.py</code>，目录列表如下:</p> <ul> <li>如果使用解释器，当前目录或者输入脚本运行目录</li> <li>在PYTHONPATH环境变量中包含的目录</li> <li>python安装时配置的依赖安装的列表目录</li> </ul> <p>这个搜索路径可以从python的变量sys.path中查看。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="p">.</span><span class="n">path</span>
<span class="p">[</span><span class="s">''</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">john</span><span class="se">\\</span><span class="s">Documents</span><span class="se">\\</span><span class="s">Python</span><span class="se">\\</span><span class="s">doc'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">Lib</span><span class="se">\\</span><span class="s">idlelib'</span><span class="p">,</span>
<span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">python36.zip'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">DLLs'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">lib'</span><span class="p">,</span>
<span class="s">'C:</span><span class="se">\\</span><span class="s">Python36'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">lib</span><span class="se">\\</span><span class="s">site-packages'</span><span class="p">]</span>
</code></pre></div></div> <p>为了保证调用时可以找到<code class="language-plaintext highlighter-rouge">mod.py</code>，需要做下面的其中一件事:</p> <ul> <li>如果使用解释器，将<code class="language-plaintext highlighter-rouge">mod.py</code>放到输入脚本对应的目录或者当前目录</li> <li>更改环境变量<code class="language-plaintext highlighter-rouge">PYTHONPATH</code>来包含<code class="language-plaintext highlighter-rouge">mod.py</code>所处的目录</li> <li>将<code class="language-plaintext highlighter-rouge">mod.py</code>放到依赖安装的目录下</li> </ul> <p>当然也可以在运行时更改<code class="language-plaintext highlighter-rouge">sys.path</code>.比如:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s">'C:\Users\john'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="p">.</span><span class="n">path</span>
<span class="p">[</span><span class="s">''</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">john</span><span class="se">\\</span><span class="s">Documents</span><span class="se">\\</span><span class="s">Python</span><span class="se">\\</span><span class="s">doc'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">Lib</span><span class="se">\\</span><span class="s">idlelib'</span><span class="p">,</span>
<span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">python36.zip'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">DLLs'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">lib'</span><span class="p">,</span>
<span class="s">'C:</span><span class="se">\\</span><span class="s">Python36'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">lib</span><span class="se">\\</span><span class="s">site-packages'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">john'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
</code></pre></div></div> <p>导入一个模块之后，可以通过<code class="language-plaintext highlighter-rouge">__file__</code>属性查看文件从哪里导入的:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">__file__</span>
<span class="s">'C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">john</span><span class="se">\\</span><span class="s">mod.py'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">re</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">__file__</span>
<span class="s">'C:</span><span class="se">\\</span><span class="s">Python36</span><span class="se">\\</span><span class="s">lib</span><span class="se">\\</span><span class="s">re.py'</span>
</code></pre></div></div> <h2 id="import语句"> <a href="#import语句" class="anchor-heading" aria-labelledby="import语句"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> import语句 </h2> <h3 id="import-module_name"> <a href="#import-module_name" class="anchor-heading" aria-labelledby="import-module_name"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">import &lt;module_name&gt;</code> </h3> <p>最简单的import语句如下:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">&lt;</span><span class="n">module_name</span><span class="o">&gt;</span>
</code></pre></div></div> <p>这句话还无法让模块内容被调用者直接可以访问，每个模块都有自己的私有符号表，作为模块中定义的所有对象的全局符号表，因此导入的是一个独立的命名空间。 <code class="language-plaintext highlighter-rouge">import &lt;module_name&gt;</code>只是把模块名放到调用者的符号表中，定义在模块中的对象还是在模块的私有符号表中。</p> <p>从调用者的角度看模块中的对象必须使用<code class="language-plaintext highlighter-rouge">.</code>符号来访问额模块的内容。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span>
<span class="o">&lt;</span><span class="n">module</span> <span class="s">'mod'</span> <span class="k">from</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">john</span><span class="se">\\</span><span class="s">Documents</span><span class="se">\\</span><span class="s">Python</span><span class="se">\\</span><span class="s">doc</span><span class="se">\\</span><span class="s">mod.py'</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="nb">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s">'s'</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">foo</span><span class="p">(</span><span class="s">'quux'</span><span class="p">)</span>
<span class="nb">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s">'foo'</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</code></pre></div></div> <p>这句话会把mod放到本地符号表中。 但是<code class="language-plaintext highlighter-rouge">s</code>和<code class="language-plaintext highlighter-rouge">foo</code>仍然在模块的私有符号表中，而不在本地的上下文中。</p> <p>要在本地上下文中访问必须使用以下的形式:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">s</span>
<span class="s">'If Comrade Napoleon says it, it must be right.'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">foo</span><span class="p">(</span><span class="s">'quux'</span><span class="p">)</span>
<span class="n">arg</span> <span class="o">=</span> <span class="n">quux</span>
</code></pre></div></div> <p>可以使用逗号分割导入多个模块，<code class="language-plaintext highlighter-rouge">import &lt;module_name&gt;[, &lt;module_name&gt; ...]</code>.</p> <h3 id="from-module_name-import-names"> <a href="#from-module_name-import-names" class="anchor-heading" aria-labelledby="from-module_name-import-names"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">from &lt;module_name&gt; import &lt;name(s)&gt;</code> </h3> <p>要直接把模块中的名字导入调用者的符号表中可以使用:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">from</span> <span class="o">&lt;</span><span class="n">module_name</span><span class="o">&gt;</span> <span class="k">import</span> <span class="o">&lt;</span><span class="n">name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">&gt;</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">s</span><span class="p">,</span> <span class="n">foo</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="s">'If Comrade Napoleon says it, it must be right.'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">foo</span><span class="p">(</span><span class="s">'quux'</span><span class="p">)</span>
<span class="n">arg</span> <span class="o">=</span> <span class="n">quux</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">Foo</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="o">&lt;</span><span class="n">mod</span><span class="p">.</span><span class="n">Foo</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x02E3AD50</span><span class="o">&gt;</span>
</code></pre></div></div> <p>这很容易符号已经存在在本地符号表中的名字，比如:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s">'foo'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">,</span> <span class="s">'baz'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="p">[</span><span class="s">'foo'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">,</span> <span class="s">'baz'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">a</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
</code></pre></div></div> <p>甚至还有一种更讨厌的写法:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">from</span> <span class="o">&lt;</span><span class="n">module_name</span><span class="o">&gt;</span> <span class="k">import</span> <span class="o">*</span>
</code></pre></div></div> <p>很容易忽略掉被覆盖的名字。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="s">'If Comrade Napoleon says it, it must be right.'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">foo</span>
<span class="o">&lt;</span><span class="n">function</span> <span class="n">foo</span> <span class="n">at</span> <span class="mh">0x03B449C0</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Foo</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">mod</span><span class="p">.</span><span class="n">Foo</span><span class="s">'&gt;
</span></code></pre></div></div> <h3 id="from-module_name-import-name-as-alt_name"> <a href="#from-module_name-import-name-as-alt_name" class="anchor-heading" aria-labelledby="from-module_name-import-name-as-alt_name"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">from &lt;module_name&gt; import &lt;name&gt; as &lt;alt_name&gt;</code> </h3> <p>最推荐的写法如下:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">from</span> <span class="o">&lt;</span><span class="n">module_name</span><span class="o">&gt;</span> <span class="k">import</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="k">as</span> <span class="o">&lt;</span><span class="n">alt_name</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="k">as</span> <span class="o">&lt;</span><span class="n">alt_name</span><span class="o">&gt;</span> <span class="err">…</span><span class="p">]</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="s">'foo'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s">'foo'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">,</span> <span class="s">'baz'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">s</span> <span class="k">as</span> <span class="n">string</span><span class="p">,</span> <span class="n">a</span> <span class="k">as</span> <span class="n">alist</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="s">'foo'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">string</span>
<span class="s">'If Comrade Napoleon says it, it must be right.'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="p">[</span><span class="s">'foo'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">,</span> <span class="s">'baz'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">alist</span>
<span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
</code></pre></div></div> <h3 id="import-module_name-as-alt_name"> <a href="#import-module_name-as-alt_name" class="anchor-heading" aria-labelledby="import-module_name-as-alt_name"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">import &lt;module_name&gt; as &lt;alt_name&gt;</code> </h3> <p>也可以单独再起一个别名:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span> <span class="k">as</span> <span class="n">my_module</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">my_module</span><span class="p">.</span><span class="n">a</span>
<span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">my_module</span><span class="p">.</span><span class="n">foo</span><span class="p">(</span><span class="s">'qux'</span><span class="p">)</span>
<span class="n">arg</span> <span class="o">=</span> <span class="n">qux</span>
</code></pre></div></div> <p>也可以在函数调用的时候再进行<code class="language-plaintext highlighter-rouge">import</code>,这样包只在函数调用的时候才会可见。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
<span class="p">...</span>     <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">foo</span>
<span class="p">...</span>     <span class="n">foo</span><span class="p">(</span><span class="s">'corge'</span><span class="p">)</span>
<span class="p">...</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bar</span><span class="p">()</span>
<span class="n">arg</span> <span class="o">=</span> <span class="n">corge</span>
</code></pre></div></div> <p>但是在python3中不支持如下写法:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
<span class="p">...</span>     <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="o">*</span>
<span class="p">...</span>
<span class="nb">SyntaxError</span><span class="p">:</span> <span class="k">import</span> <span class="o">*</span> <span class="n">only</span> <span class="n">allowed</span> <span class="n">at</span> <span class="n">module</span> <span class="n">level</span>
</code></pre></div></div> <p>如果希望避免异常的导入可以使用:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">try</span><span class="p">:</span>
<span class="p">...</span>     <span class="c1"># Non-existent module
</span><span class="p">...</span>     <span class="kn">import</span> <span class="nn">baz</span>
<span class="p">...</span> <span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
<span class="p">...</span>     <span class="k">print</span><span class="p">(</span><span class="s">'Module not found'</span><span class="p">)</span>
<span class="p">...</span>

<span class="n">Module</span> <span class="ow">not</span> <span class="n">found</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">try</span><span class="p">:</span>
<span class="p">...</span>     <span class="c1"># Existing module, but non-existent object
</span><span class="p">...</span>     <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">baz</span>
<span class="p">...</span> <span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
<span class="p">...</span>     <span class="k">print</span><span class="p">(</span><span class="s">'Object not found in module'</span><span class="p">)</span>
<span class="p">...</span>

<span class="n">Object</span> <span class="ow">not</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">module</span>
</code></pre></div></div> <h2 id="dir函数"> <a href="#dir函数" class="anchor-heading" aria-labelledby="dir函数"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> dir函数 </h2> <p>内建的<code class="language-plaintext highlighter-rouge">dir</code>函数可以返回命名空间中的名字列表，不带参数的话返回的是本地符号表:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">qux</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'qux'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Bar</span><span class="p">():</span>
<span class="p">...</span>     <span class="k">pass</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'Bar'</span><span class="p">,</span> <span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'qux'</span><span class="p">,</span> <span class="s">'x'</span><span class="p">]</span>
</code></pre></div></div> <p>这个函数可以用来确定import到底导入了那些名字:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'mod'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">s</span>
<span class="s">'If Comrade Napoleon says it, it must be right.'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">foo</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">arg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">Foo</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'Foo'</span><span class="p">,</span> <span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'mod'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="o">&lt;</span><span class="n">mod</span><span class="p">.</span><span class="n">Foo</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x002EAD50</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="n">s</span> <span class="k">as</span> <span class="n">string</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'Foo'</span><span class="p">,</span> <span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'mod'</span><span class="p">,</span> <span class="s">'string'</span><span class="p">,</span> <span class="s">'x'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">string</span>
<span class="s">'If Comrade Napoleon says it, it must be right.'</span>
</code></pre></div></div> <p>列出模块中的名字:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="p">[</span><span class="s">'Foo'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__cached__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__file__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span>
<span class="s">'__name__'</span><span class="p">,</span> <span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'foo'</span><span class="p">,</span> <span class="s">'s'</span><span class="p">]</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">mod</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'Foo'</span><span class="p">,</span> <span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'foo'</span><span class="p">,</span> <span class="s">'s'</span><span class="p">]</span>
</code></pre></div></div> <h2 id="将模块作为脚本执行"> <a href="#将模块作为脚本执行" class="anchor-heading" aria-labelledby="将模块作为脚本执行"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 将模块作为脚本执行 </h2> <p>包含模块的py文件又叫做脚本，因此也是可以执行的。<code class="language-plaintext highlighter-rouge">mod.py</code>:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="s">"If Comrade Napoleon says it, it must be right."</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'arg = </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">foo</span><span class="p">(</span><span class="s">'quux'</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\john\Documents&gt;python mod.py
If Comrade Napoleon says it, it must be right.
[100, 200, 300]
arg = quux
&lt;__main__.Foo object at 0x02F101D0&gt;
</code></pre></div></div> <p>但是在进行import的时候这些语句也会执行，可以使用以下的方式区分执行模块还是进行import:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="s">"If Comrade Napoleon says it, it must be right."</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'arg = </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="p">(</span><span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Executing as standalone script'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">(</span><span class="s">'quux'</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div> <p>在导入模块时，python会设置模块的dunder变量<code class="language-plaintext highlighter-rouge">__name__</code>，如果作为单独的脚本进行执行会设置成<code class="language-plaintext highlighter-rouge">__main__</code>。 这一特征在单元测试时比较有用。</p> <h2 id="重新加载模块"> <a href="#重新加载模块" class="anchor-heading" aria-labelledby="重新加载模块"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 重新加载模块 </h2> <p>处于效率的原因，一个解释器会话智慧进行inmport一次，对于函数或者类定义来说比较正常，但是模块可能包含一些初始化的语句，</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s">'a ='</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="p">.</span><span class="n">a</span>
<span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
</code></pre></div></div> <p>在后续的导入中并没有执行<code class="language-plaintext highlighter-rouge">print</code>语句。如果修改了模块需要重新加载，可以关掉解释器重新打开或者使用<code class="language-plaintext highlighter-rouge">reload()</code>函数。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mod</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">importlib</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">importlib</span><span class="p">.</span><span class="nb">reload</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">module</span> <span class="s">'mod'</span> <span class="k">from</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">john</span><span class="se">\\</span><span class="s">Documents</span><span class="se">\\</span><span class="s">Python</span><span class="se">\\</span><span class="s">doc</span><span class="se">\\</span><span class="s">mod.py'</span><span class="o">&gt;</span>
</code></pre></div></div> <h1 id="packages"> <a href="#packages" class="anchor-heading" aria-labelledby="packages"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Packages </h1> <p>包通过<code class="language-plaintext highlighter-rouge">.</code>符号支持模块命名空间具有层级的结构，包避免了模块名之间的冲突。</p> <p>直接使用文件夹层级结构就可以创建一个包，</p> <p>mod1.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod1] foo()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <p>mod2.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod2] bar()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Bar</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.mod1</span> <span class="kn">import</span> <span class="n">foo</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>

</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pkg.mod1</span><span class="p">,</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod1</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span><span class="p">.</span><span class="n">Bar</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="o">&lt;</span><span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span><span class="p">.</span><span class="n">Bar</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x033F7290</span><span class="o">&gt;</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.mod2</span> <span class="kn">import</span> <span class="n">Bar</span> <span class="k">as</span> <span class="n">Qux</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Qux</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="o">&lt;</span><span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span><span class="p">.</span><span class="n">Bar</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x036DFFD0</span><span class="o">&gt;</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg</span> <span class="kn">import</span> <span class="n">mod1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod1</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg</span> <span class="kn">import</span> <span class="n">mod2</span> <span class="k">as</span> <span class="n">quux</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">quux</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod2</span><span class="p">]</span> <span class="n">bar</span><span class="p">()</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pkg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span>
<span class="o">&lt;</span><span class="n">module</span> <span class="s">'pkg'</span> <span class="p">(</span><span class="n">namespace</span><span class="p">)</span><span class="o">&gt;</span>
</code></pre></div></div> <p>如上所示包的导入和模块的导入没什么不同， 下面的语句语法上看好像没问题，但是不会把模块放到本地的命名空间中:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod1</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">"&lt;pyshell#34&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">pkg</span><span class="p">.</span><span class="n">mod1</span>
<span class="nb">AttributeError</span><span class="p">:</span> <span class="n">module</span> <span class="s">'pkg'</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s">'mod1'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod1</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">"&lt;pyshell#35&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">pkg</span><span class="p">.</span><span class="n">mod1</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="nb">AttributeError</span><span class="p">:</span> <span class="n">module</span> <span class="s">'pkg'</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s">'mod1'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span><span class="p">.</span><span class="n">Bar</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">"&lt;pyshell#36&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span><span class="p">.</span><span class="n">Bar</span><span class="p">()</span>
<span class="nb">AttributeError</span><span class="p">:</span> <span class="n">module</span> <span class="s">'pkg'</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s">'mod2'</span>
</code></pre></div></div> <h2 id="包初始化"> <a href="#包初始化" class="anchor-heading" aria-labelledby="包初始化"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 包初始化 </h2> <p>如果包的目录下有一个叫做<code class="language-plaintext highlighter-rouge">__init__.py</code>的文件，在包或者包里面的模块被import时会自动调用。这可以用来执行包的初始化代码，比如初始化包一层的数据:</p> <p>init.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Invoking __init__.py for </span><span class="si">{</span><span class="n">__name__</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s">'quux'</span><span class="p">,</span> <span class="s">'corge'</span><span class="p">,</span> <span class="s">'grault'</span><span class="p">]</span>
</code></pre></div></div> <p><img src="https://files.realpython.com/media/pkg2.dab97c2f9c58.png" alt="" /></p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pkg</span>
<span class="n">Invoking</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span> <span class="k">for</span> <span class="n">pkg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">A</span>
<span class="p">[</span><span class="s">'quux'</span><span class="p">,</span> <span class="s">'corge'</span><span class="p">,</span> <span class="s">'grault'</span><span class="p">]</span>
</code></pre></div></div> <p>当导入包时会初始化全局列表<code class="language-plaintext highlighter-rouge">A</code>,包中的模块可以通过import访问全局变量：</p> <p>mod1.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">pkg</span> <span class="kn">import</span> <span class="n">A</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod1] foo() / A = '</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg</span> <span class="kn">import</span> <span class="n">mod1</span>
<span class="n">Invoking</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span> <span class="k">for</span> <span class="n">pkg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod1</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span> <span class="o">/</span> <span class="n">A</span> <span class="o">=</span>  <span class="p">[</span><span class="s">'quux'</span><span class="p">,</span> <span class="s">'corge'</span><span class="p">,</span> <span class="s">'grault'</span><span class="p">]</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">__init__.py</code>还可以用来影响从一个包中对模块的自动导入，比如之前的例子中只把<code class="language-plaintext highlighter-rouge">pkg</code>放在调用者的本地符号变量而没有导入任何模块，但是如果<code class="language-plaintext highlighter-rouge">__init__.py</code>包含下列代码:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Invoking __init__.py for </span><span class="si">{</span><span class="n">__name__</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pkg.mod1</span><span class="p">,</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span>
</code></pre></div></div> <p>可以实现:</p> <div class="language-py note highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pkg</span>
<span class="n">Invoking</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span> <span class="k">for</span> <span class="n">pkg</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod1</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">mod2</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod2</span><span class="p">]</span> <span class="n">bar</span><span class="p">()</span>
</code></pre></div></div> <p>python3.3之后引入了隐式的命名空间包，可以没有<code class="language-plaintext highlighter-rouge">__init__</code>文件就能创建包。</p> <h2 id="命名空间包"> <a href="#命名空间包" class="anchor-heading" aria-labelledby="命名空间包"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 命名空间包 </h2> <p>https://realpython.com/python-namespace-package/</p> <h2 id="import-"> <a href="#import-" class="anchor-heading" aria-labelledby="import-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">import *</code> </h2> <p>在之前我们看到了模块的<code class="language-plaintext highlighter-rouge">import *</code>，下面谈一下包的:</p> <p><img src="https://files.realpython.com/media/pkg3.d2160908ae77.png" alt="" /></p> <p>mod1.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod1] foo()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <p>mod2.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod2] bar()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Bar</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <p>mod3.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">baz</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod3] baz()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Baz</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <p>mod4.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">qux</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod4] qux()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Qux</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div> <p>对于模块<code class="language-plaintext highlighter-rouge">import *</code>会跳过双下划线开头的名字，</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.mod3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'Baz'</span><span class="p">,</span> <span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'baz'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">baz</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod3</span><span class="p">]</span> <span class="n">baz</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Baz</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">pkg</span><span class="p">.</span><span class="n">mod3</span><span class="p">.</span><span class="n">Baz</span><span class="s">'&gt;
</span></code></pre></div></div> <p>对于包:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">]</span>
</code></pre></div></div> <p>没有从包里导入任何名字，python 有这样的传统，如果<code class="language-plaintext highlighter-rouge">__init__</code>文件中定义了一个<code class="language-plaintext highlighter-rouge">__all__</code>的列表，在使用<code class="language-plaintext highlighter-rouge">import *</code>时会调入这个列表中的东西。</p> <p>对于上面的例子如果使用:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">'mod1'</span><span class="p">,</span>
        <span class="s">'mod2'</span><span class="p">,</span>
        <span class="s">'mod3'</span><span class="p">,</span>
        <span class="s">'mod4'</span>
        <span class="p">]</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">()</span>
<span class="p">[</span><span class="s">'__annotations__'</span><span class="p">,</span> <span class="s">'__builtins__'</span><span class="p">,</span> <span class="s">'__doc__'</span><span class="p">,</span> <span class="s">'__loader__'</span><span class="p">,</span> <span class="s">'__name__'</span><span class="p">,</span>
<span class="s">'__package__'</span><span class="p">,</span> <span class="s">'__spec__'</span><span class="p">,</span> <span class="s">'mod1'</span><span class="p">,</span> <span class="s">'mod2'</span><span class="p">,</span> <span class="s">'mod3'</span><span class="p">,</span> <span class="s">'mod4'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod2</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod2</span><span class="p">]</span> <span class="n">bar</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod4</span><span class="p">.</span><span class="n">Qux</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">pkg</span><span class="p">.</span><span class="n">mod4</span><span class="p">.</span><span class="n">Qux</span><span class="s">'&gt;
</span></code></pre></div></div> <p>这样对于包来说使用<code class="language-plaintext highlighter-rouge">import *</code>就不像模块一样糟糕了。在模块中也可以使用<code class="language-plaintext highlighter-rouge">__all__</code>。这样就只会import<code class="language-plaintext highlighter-rouge">__all__</code>中的名字。 总之<code class="language-plaintext highlighter-rouge">__all__</code>就是用来控制<code class="language-plaintext highlighter-rouge">import *</code>的行为的。</p> <h2 id="子包"> <a href="#子包" class="anchor-heading" aria-labelledby="子包"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 子包 </h2> <p>包可以在任意层级上嵌入子包，</p> <p><img src="https://files.realpython.com/media/pkg4.a830d6e144bf.png" alt="" /></p> <p>这里分成了两个子包，<code class="language-plaintext highlighter-rouge">sub_pkg1</code>和<code class="language-plaintext highlighter-rouge">sub_pkg2</code>.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pkg.sub_pkg1.mod1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pkg</span><span class="p">.</span><span class="n">sub_pkg1</span><span class="p">.</span><span class="n">mod1</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.sub_pkg1</span> <span class="kn">import</span> <span class="n">mod2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod2</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod2</span><span class="p">]</span> <span class="n">bar</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.sub_pkg2.mod3</span> <span class="kn">import</span> <span class="n">baz</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">baz</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod3</span><span class="p">]</span> <span class="n">baz</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.sub_pkg2.mod4</span> <span class="kn">import</span> <span class="n">qux</span> <span class="k">as</span> <span class="n">grault</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">grault</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod4</span><span class="p">]</span> <span class="n">qux</span><span class="p">()</span>
</code></pre></div></div> <p>在一个子包中的模块可以引用兄弟子包中的对象，比如从<code class="language-plaintext highlighter-rouge">mod3</code>引用<code class="language-plaintext highlighter-rouge">mod1</code>中的可以使用绝对导入:</p> <p>pkg/sub__pkg2/mod3.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">baz</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod3] baz()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Baz</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="kn">from</span> <span class="nn">pkg.sub_pkg1.mod1</span> <span class="kn">import</span> <span class="n">foo</span>
<span class="n">foo</span><span class="p">()</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.sub_pkg2</span> <span class="kn">import</span> <span class="n">mod3</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod3</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>
</code></pre></div></div> <p>也可以使用相对导入:</p> <p>pkg/sub__pkg2/mod3.py</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">baz</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[mod3] baz()'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Baz</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sub_pkg1</span>
<span class="k">print</span><span class="p">(</span><span class="n">sub_pkg1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">..sub_pkg1.mod1</span> <span class="kn">import</span> <span class="n">foo</span>
<span class="n">foo</span><span class="p">()</span>
</code></pre></div></div> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pkg.sub_pkg2</span> <span class="kn">import</span> <span class="n">mod3</span>
<span class="o">&lt;</span><span class="n">module</span> <span class="s">'pkg.sub_pkg1'</span> <span class="p">(</span><span class="n">namespace</span><span class="p">)</span><span class="o">&gt;</span>
<span class="p">[</span><span class="n">mod1</span><span class="p">]</span> <span class="n">foo</span><span class="p">()</span>
</code></pre></div></div> <h1 id="import"> <a href="#import" class="anchor-heading" aria-labelledby="import"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Import </h1> <p>python的import如何工作的?当我们输入:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">abc</span>
</code></pre></div></div> <ul> <li>python首先在<code class="language-plaintext highlighter-rouge">sys.modules</code>查找名字<code class="language-plaintext highlighter-rouge">abc</code>，所有之前导入的模块名字会缓存在其中。</li> <li>如果没在模块缓存中找到，将会在内建的模块(python标准库)中进行搜索</li> <li>如果没找到会搜索sys.path定义的目录列表中搜索，这个列表一般包含当前目录，而且会首先搜索当前目录</li> <li>在找到模块后会将其绑定到本地作用域上，没找到则会有<code class="language-plaintext highlighter-rouge">ModuleNotFoundError</code></li> </ul> <p>PEP8风格的<code class="language-plaintext highlighter-rouge">import</code>：</p> <ul> <li>import 都应该卸载文件的开头在模块注释和docstring的后面</li> <li>import 应该分成几个部分，通常有下面三个部分并用空行隔开: <ul> <li>标注库导入(内建模块)</li> <li>第三方<code class="language-plaintext highlighter-rouge">import</code>(安装的模块)</li> <li>本地<code class="language-plaintext highlighter-rouge">import</code></li> </ul> </li> <li>按字母顺序排序</li> </ul> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Illustration of good import statement styling.

Note that the imports come after the docstring.

"""</span>

<span class="c1"># Standard library imports
</span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Third party imports
</span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_restful</span> <span class="kn">import</span> <span class="n">Api</span>
<span class="kn">from</span> <span class="nn">flask_sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span>

<span class="c1"># Local application imports
</span><span class="kn">from</span> <span class="nn">local_module</span> <span class="kn">import</span> <span class="n">local_class</span>
<span class="kn">from</span> <span class="nn">local_package</span> <span class="kn">import</span> <span class="n">local_function</span>
</code></pre></div></div> <h2 id="绝对导入"> <a href="#绝对导入" class="anchor-heading" aria-labelledby="绝对导入"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 绝对导入 </h2> <p>绝对导入是从项目根目录开始的导入，</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">└──</span> <span class="n">project</span>
    <span class="err">├──</span> <span class="n">package1</span>
    <span class="err">│</span>   <span class="err">├──</span> <span class="n">module1</span><span class="p">.</span><span class="n">py</span>
    <span class="err">│</span>   <span class="err">└──</span> <span class="n">module2</span><span class="p">.</span><span class="n">py</span>
    <span class="err">└──</span> <span class="n">package2</span>
        <span class="err">├──</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span>
        <span class="err">├──</span> <span class="n">module3</span><span class="p">.</span><span class="n">py</span>
        <span class="err">├──</span> <span class="n">module4</span><span class="p">.</span><span class="n">py</span>
        <span class="err">└──</span> <span class="n">subpackage1</span>
            <span class="err">└──</span> <span class="n">module5</span><span class="p">.</span><span class="n">py</span>
</code></pre></div></div> <p>假设:</p> <ol> <li>package1/module2.py 有函数function1.</li> <li>package2/<strong>init</strong>.py 有类class1.</li> <li>package2/subpackage1/module5.py 有函数function2.</li> </ol> <p>下面是绝对导入的例子:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">package1</span> <span class="kn">import</span> <span class="n">module1</span>
<span class="kn">from</span> <span class="nn">package1.module2</span> <span class="kn">import</span> <span class="n">function1</span>
<span class="kn">from</span> <span class="nn">package2</span> <span class="kn">import</span> <span class="n">class1</span>
<span class="kn">from</span> <span class="nn">package2.subpackage1.module5</span> <span class="kn">import</span> <span class="n">function2</span>
</code></pre></div></div> <p>绝对导入对导入路径非常的清晰，一般建议使用绝对导入，但是目录结构很大的时候绝对导入太过冗余。</p> <h2 id="相对导入"> <a href="#相对导入" class="anchor-heading" aria-labelledby="相对导入"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 相对导入 </h2> <p>相对导入指的时相对当前位置的导入路径，有两种相对导入，显式和隐式的，python3中不赞成使用隐式导入。</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.some_module</span> <span class="kn">import</span> <span class="n">some_class</span>
<span class="kn">from</span> <span class="nn">..some_package</span> <span class="kn">import</span> <span class="n">some_function</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">some_class</span>
</code></pre></div></div> <p>相对导入取决于当前位置和导入的包或者模块的位置，<code class="language-plaintext highlighter-rouge">.</code>意味着导入位置和当前位置相同，<code class="language-plaintext highlighter-rouge">..</code>意味着导入位置在当前位置的父目录上，<code class="language-plaintext highlighter-rouge">...</code>意味着在祖父目录上，以此类推。 假设目录结构如下:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>└── project
    ├── package1
    │   ├── module1.py
    │   └── module2.py
    └── package2
        ├── __init__.py
        ├── module3.py
        ├── module4.py
        └── subpackage1
            └── module5.py
</code></pre></div></div> <ol> <li>package1/module2.py 有函数 function1.</li> <li>package2/<strong>init</strong>.py 有类 class1.</li> <li>package2/subpackage1/module5.py 有函数 function2.</li> </ol> <p>将function1 导入到module1中</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># package1/module1.py
</span>
<span class="kn">from</span> <span class="nn">.module2</span> <span class="kn">import</span> <span class="n">function1</span>
</code></pre></div></div> <p>将class1导入到module3中:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># package2/module3.py
</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">class1</span>
<span class="kn">from</span> <span class="nn">.subpackage1.module5</span> <span class="kn">import</span> <span class="n">function2</span>
</code></pre></div></div> <p>总之相对导入不建议使用。</p> <h1 id="advanced-import"> <a href="#advanced-import" class="anchor-heading" aria-labelledby="advanced-import"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced import </h1> <h2 id="基础"> <a href="#基础" class="anchor-heading" aria-labelledby="基础"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 基础 </h2> <h2 id="资源import"> <a href="#资源import" class="anchor-heading" aria-labelledby="资源import"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 资源import </h2> <h2 id="动态import"> <a href="#动态import" class="anchor-heading" aria-labelledby="动态import"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 动态import </h2> <h2 id="import系统"> <a href="#import系统" class="anchor-heading" aria-labelledby="import系统"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> import系统 </h2> <h2 id="tips"> <a href="#tips" class="anchor-heading" aria-labelledby="tips"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tips </h2> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
